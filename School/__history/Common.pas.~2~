unit Common;

interface

uses DMUN,Data.DB,Data.Win.ADODB,System.SysUtils;
Type
  TValidationType = (tvdtIdInUse = 1 ,tvdtIdNotExist = 2 );

Function IsValid(TableName,FieldName : String;FieldValue : Integer; ValidType : TValidationType): Boolean;

implementation

Function IsValid(TableName : String;FieldName : String; FieldValue : Integer; ValidType : TValidationType): Boolean;
begin
  Result := False;
  With TADOQuery.Create(Nil) DO
  begin
    Connection := DataModule1.ADOConnection1;
    SQL.Clear;
    if ValidType = tvdtIdInUse then
    begin
      SQL.Add(Format('Select * From %s Where %s = %s',[TableName,FieldName,FieldValue]));
      Open;
      if Not IsEmpty then
        Result := True;
    end
    else
    if ValidType = tvdtIdNotExist then
    begin
      SQL.Add(Format('Select * From %s Where %s = %s',[TableName,FieldName,FieldValue]));
      Open;
      if  IsEmpty then
        Result := True;
    end;
  end;

end;


end.
